import { ChangeDetectionStrategy, Component, Inject, Input, ViewChild, ElementRef, PLATFORM_ID, } from '@angular/core';
import { isPlatformBrowser } from '@angular/common';
import { ADSENSE_TOKEN } from './adsense-config';
import * as ɵngcc0 from '@angular/core';

const _c0 = ["ins"];
export class AdsenseComponent {
    constructor(config, 
    // eslint-disable-next-line @typescript-eslint/no-explicit-any
    platform) {
        this.config = config;
        this.platform = platform;
        /** can be manually set if you need all ads on a page to have same id page-xxx */
        this.adRegion = 'page-' + Math.floor(Math.random() * 10000) + 1;
        /**
         * classes applied to the ins element
         */
        this.className = '';
    }
    ngOnInit() {
        var _a, _b, _c, _d, _e, _f, _g, _h, _j, _k, _l, _m, _o;
        const config = this.config;
        this.adClient = (_a = this.adClient) !== null && _a !== void 0 ? _a : config.adClient;
        this.adSlot = (_b = this.adSlot) !== null && _b !== void 0 ? _b : config.adSlot;
        this.adFormat = (_d = (_c = this.adFormat) !== null && _c !== void 0 ? _c : config.adFormat) !== null && _d !== void 0 ? _d : 'auto';
        this.display = (_f = (_e = this.display) !== null && _e !== void 0 ? _e : config.display) !== null && _f !== void 0 ? _f : 'block';
        this.width = (_g = this.width) !== null && _g !== void 0 ? _g : config.width;
        this.height = (_h = this.height) !== null && _h !== void 0 ? _h : config.height;
        this.layout = (_j = this.layout) !== null && _j !== void 0 ? _j : config.layout;
        this.layoutKey = (_k = this.layoutKey) !== null && _k !== void 0 ? _k : config.layoutKey;
        this.pageLevelAds = (_l = this.pageLevelAds) !== null && _l !== void 0 ? _l : config.pageLevelAds;
        this.adtest = (_m = this.adtest) !== null && _m !== void 0 ? _m : config.adtest;
        this.fullWidthResponsive = (_o = this.fullWidthResponsive) !== null && _o !== void 0 ? _o : config.fullWidthResponsive;
    }
    ngOnDestroy() {
        const iframe = this.ins.nativeElement.querySelector('iframe');
        if (iframe && iframe.contentWindow) {
            iframe.src = 'about:blank';
            iframe.remove();
        }
    }
    ngAfterViewInit() {
        if (isPlatformBrowser(this.platform)) {
            this.push();
        }
    }
    push() {
        const p = {};
        if (this.pageLevelAds) {
            p.google_ad_client = this.adClient;
            p.enable_page_level_ads = true;
        }
        if (window) {
            try {
                // eslint-disable-next-line @typescript-eslint/no-explicit-any
                (window.adsbygoogle = window.adsbygoogle || []).push(p);
            }
            catch (_a) {
                // pass
            }
        }
    }
}
AdsenseComponent.ɵfac = function AdsenseComponent_Factory(t) { return new (t || AdsenseComponent)(ɵngcc0.ɵɵdirectiveInject(ADSENSE_TOKEN), ɵngcc0.ɵɵdirectiveInject(PLATFORM_ID)); };
AdsenseComponent.ɵcmp = ɵngcc0.ɵɵdefineComponent({ type: AdsenseComponent, selectors: [["ng2-adsense"], ["ng-adsense"]], viewQuery: function AdsenseComponent_Query(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵstaticViewQuery(_c0, true, ElementRef);
    } if (rf & 2) {
        let _t;
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.ins = _t.first);
    } }, inputs: { adRegion: "adRegion", className: "className", adClient: "adClient", adSlot: "adSlot", adFormat: "adFormat", display: "display", width: "width", height: "height", layout: "layout", layoutKey: "layoutKey", pageLevelAds: "pageLevelAds", adtest: "adtest", fullWidthResponsive: "fullWidthResponsive" }, decls: 2, vars: 17, consts: [["ins", ""]], template: function AdsenseComponent_Template(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵelement(0, "ins", null, 0);
    } if (rf & 2) {
        ɵngcc0.ɵɵclassMapInterpolate1("adsbygoogle ", ctx.className, "");
        ɵngcc0.ɵɵstyleProp("display", ctx.display)("width", ctx.width, "px")("height", ctx.height, "px");
        ɵngcc0.ɵɵattribute("data-ad-client", ctx.adClient)("data-ad-slot", ctx.adSlot)("data-ad-format", ctx.adFormat)("data-ad-region", ctx.adRegion)("data-layout", ctx.layout)("data-adtest", ctx.adtest)("data-layout-key", ctx.layoutKey)("data-full-width-responsive", ctx.fullWidthResponsive);
    } }, encapsulation: 2, changeDetection: 0 });
AdsenseComponent.ctorParameters = () => [
    { type: undefined, decorators: [{ type: Inject, args: [ADSENSE_TOKEN,] }] },
    { type: undefined, decorators: [{ type: Inject, args: [PLATFORM_ID,] }] }
];
AdsenseComponent.propDecorators = {
    adClient: [{ type: Input }],
    adSlot: [{ type: Input }],
    adFormat: [{ type: Input }],
    adRegion: [{ type: Input }],
    display: [{ type: Input }],
    width: [{ type: Input }],
    height: [{ type: Input }],
    layout: [{ type: Input }],
    layoutKey: [{ type: Input }],
    pageLevelAds: [{ type: Input }],
    adtest: [{ type: Input }],
    fullWidthResponsive: [{ type: Input }],
    className: [{ type: Input }],
    ins: [{ type: ViewChild, args: ['ins', { read: ElementRef, static: true },] }]
};
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(AdsenseComponent, [{
        type: Component,
        args: [{
                selector: 'ng2-adsense,ng-adsense',
                template: `
    <ins
      #ins
      class="adsbygoogle {{ className }}"
      [style.display]="display"
      [style.width.px]="width"
      [style.height.px]="height"
      [attr.data-ad-client]="adClient"
      [attr.data-ad-slot]="adSlot"
      [attr.data-ad-format]="adFormat"
      [attr.data-ad-region]="adRegion"
      [attr.data-layout]="layout"
      [attr.data-adtest]="adtest"
      [attr.data-layout-key]="layoutKey"
      [attr.data-full-width-responsive]="fullWidthResponsive"
    >
    </ins>
  `,
                changeDetection: ChangeDetectionStrategy.OnPush
            }]
    }], function () { return [{ type: undefined, decorators: [{
                type: Inject,
                args: [ADSENSE_TOKEN]
            }] }, { type: undefined, decorators: [{
                type: Inject,
                args: [PLATFORM_ID]
            }] }]; }, { adRegion: [{
            type: Input
        }], className: [{
            type: Input
        }], adClient: [{
            type: Input
        }], adSlot: [{
            type: Input
        }], adFormat: [{
            type: Input
        }], display: [{
            type: Input
        }], width: [{
            type: Input
        }], height: [{
            type: Input
        }], layout: [{
            type: Input
        }], layoutKey: [{
            type: Input
        }], pageLevelAds: [{
            type: Input
        }], adtest: [{
            type: Input
        }], fullWidthResponsive: [{
            type: Input
        }], ins: [{
            type: ViewChild,
            args: ['ins', { read: ElementRef, static: true }]
        }] }); })();

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYWRzZW5zZS5jb21wb25lbnQuanMiLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9saWIvYWRzZW5zZS5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUVMLHVCQUF1QixFQUN2QixTQUFTLEVBQ1QsTUFBTSxFQUNOLEtBQUssRUFHTCxTQUFTLEVBQ1QsVUFBVSxFQUNWLFdBQVcsR0FDWixNQUFNLGVBQWUsQ0FBQztBQUN2QixPQUFPLEVBQUUsaUJBQWlCLEVBQUUsTUFBTSxpQkFBaUIsQ0FBQztBQUVwRCxPQUFPLEVBQUUsYUFBYSxFQUFpQixNQUFNLGtCQUFrQixDQUFDOzs7O0FBd0JoRSxNQUFNLE9BQU8sZ0JBQWdCO0FBQUcsSUE4QjlCLFlBQ2lDLE1BQXFCO0FBQ3ZELElBQUcsOERBQThEO0FBQ2xFLElBQWlDLFFBQWE7QUFDNUMsUUFIaUMsV0FBTSxHQUFOLE1BQU0sQ0FBZTtBQUFDLFFBRXhCLGFBQVEsR0FBUixRQUFRLENBQUs7QUFBQyxRQTNCN0MsaUZBQWlGO0FBQ25GLFFBQVcsYUFBUSxHQUFHLE9BQU8sR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxNQUFNLEVBQUUsR0FBRyxLQUFLLENBQUMsR0FBRyxDQUFDLENBQUM7QUFDdEUsUUFnQkU7QUFDRjtBQUVBLFdBREs7QUFDTCxRQUFXLGNBQVMsR0FBRyxFQUFFLENBQUM7QUFDMUIsSUFNSyxDQUFDO0FBQ04sSUFDRSxRQUFRO0FBQUs7QUFFVyxRQUR0QixNQUFNLE1BQU0sR0FBRyxJQUFJLENBQUMsTUFBTSxDQUFDO0FBQy9CLFFBQUksSUFBSSxDQUFDLFFBQVEsR0FBRyxNQUFBLElBQUksQ0FBQyxRQUFRLG1DQUFJLE1BQU0sQ0FBQyxRQUFRLENBQUM7QUFDckQsUUFBSSxJQUFJLENBQUMsTUFBTSxHQUFHLE1BQUEsSUFBSSxDQUFDLE1BQU0sbUNBQUksTUFBTSxDQUFDLE1BQU0sQ0FBQztBQUMvQyxRQUFJLElBQUksQ0FBQyxRQUFRLEdBQUcsTUFBQSxNQUFBLElBQUksQ0FBQyxRQUFRLG1DQUFJLE1BQU0sQ0FBQyxRQUFRLG1DQUFJLE1BQU0sQ0FBQztBQUMvRCxRQUFJLElBQUksQ0FBQyxPQUFPLEdBQUcsTUFBQSxNQUFBLElBQUksQ0FBQyxPQUFPLG1DQUFJLE1BQU0sQ0FBQyxPQUFPLG1DQUFJLE9BQU8sQ0FBQztBQUM3RCxRQUFJLElBQUksQ0FBQyxLQUFLLEdBQUcsTUFBQSxJQUFJLENBQUMsS0FBSyxtQ0FBSSxNQUFNLENBQUMsS0FBSyxDQUFDO0FBQzVDLFFBQUksSUFBSSxDQUFDLE1BQU0sR0FBRyxNQUFBLElBQUksQ0FBQyxNQUFNLG1DQUFJLE1BQU0sQ0FBQyxNQUFNLENBQUM7QUFDL0MsUUFBSSxJQUFJLENBQUMsTUFBTSxHQUFHLE1BQUEsSUFBSSxDQUFDLE1BQU0sbUNBQUksTUFBTSxDQUFDLE1BQU0sQ0FBQztBQUMvQyxRQUFJLElBQUksQ0FBQyxTQUFTLEdBQUcsTUFBQSxJQUFJLENBQUMsU0FBUyxtQ0FBSSxNQUFNLENBQUMsU0FBUyxDQUFDO0FBQ3hELFFBQUksSUFBSSxDQUFDLFlBQVksR0FBRyxNQUFBLElBQUksQ0FBQyxZQUFZLG1DQUFJLE1BQU0sQ0FBQyxZQUFZLENBQUM7QUFDakUsUUFBSSxJQUFJLENBQUMsTUFBTSxHQUFHLE1BQUEsSUFBSSxDQUFDLE1BQU0sbUNBQUksTUFBTSxDQUFDLE1BQU0sQ0FBQztBQUMvQyxRQUFJLElBQUksQ0FBQyxtQkFBbUIsR0FBRyxNQUFBLElBQUksQ0FBQyxtQkFBbUIsbUNBQUksTUFBTSxDQUFDLG1CQUFtQixDQUFDO0FBQ3RGLElBQUUsQ0FBQztBQUNILElBQUUsV0FBVztBQUFLLFFBQ2QsTUFBTSxNQUFNLEdBQUcsSUFBSSxDQUFDLEdBQUcsQ0FBQyxhQUFhLENBQUMsYUFBYSxDQUFDLFFBQVEsQ0FBQyxDQUFDO0FBQ2xFLFFBQUksSUFBSSxNQUFNLElBQUksTUFBTSxDQUFDLGFBQWEsRUFBRTtBQUN4QyxZQUFNLE1BQU0sQ0FBQyxHQUFHLEdBQUcsYUFBYSxDQUFDO0FBQ2pDLFlBQU0sTUFBTSxDQUFDLE1BQU0sRUFBRSxDQUFDO0FBQ3RCLFNBQUs7QUFDTCxJQUFFLENBQUM7QUFDSCxJQUNFLGVBQWU7QUFBSyxRQUNsQixJQUFJLGlCQUFpQixDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsRUFBRTtBQUMxQyxZQUFNLElBQUksQ0FBQyxJQUFJLEVBQUUsQ0FBQztBQUNsQixTQUFLO0FBQ0wsSUFBRSxDQUFDO0FBQ0gsSUFDRSxJQUFJO0FBQUssUUFDUCxNQUFNLENBQUMsR0FBcUMsRUFBRSxDQUFDO0FBQ25ELFFBQUksSUFBSSxJQUFJLENBQUMsWUFBWSxFQUFFO0FBQzNCLFlBQU0sQ0FBQyxDQUFDLGdCQUFnQixHQUFHLElBQUksQ0FBQyxRQUFRLENBQUM7QUFDekMsWUFBTSxDQUFDLENBQUMscUJBQXFCLEdBQUcsSUFBSSxDQUFDO0FBQ3JDLFNBQUs7QUFDTCxRQUNJLElBQUksTUFBTSxFQUFFO0FBQ2hCLFlBQU0sSUFBSTtBQUNWLGdCQUFRLDhEQUE4RDtBQUN0RSxnQkFBUSxDQUFFLE1BQWMsQ0FBQyxXQUFXLEdBQUksTUFBYyxDQUFDLFdBQVcsSUFBSSxFQUFFLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUM7QUFDbEYsYUFBTztBQUFDLFlBQUEsV0FBTTtBQUNkLGdCQUFRLE9BQU87QUFDZixhQUFPO0FBQ1AsU0FBSztBQUNMLElBQUUsQ0FBQztBQUNIOzRDQXRHQyxTQUFTLFNBQUMsa0JBQ1QsUUFBUSxFQUFFLHdCQUF3QixrQkFDbEMsUUFBUSxFQUFFOzs7Ozs7bUdBaUJULGtCQUNELGVBQWUsRUFBRSx1QkFBdUIsQ0FBQyxNQUFNLGNBQ2hEOzs7Ozs7aURBQ0k7QUFBQztBQUEwQyw0Q0ErQjNDLE1BQU0sU0FBQyxhQUFhO0FBQVMsNENBRTdCLE1BQU0sU0FBQyxXQUFXO0FBQVE7QUFBRztBQUdwQix1QkFsQ1gsS0FBSztBQUFLLHFCQUVWLEtBQUs7QUFBSyx1QkFDVixLQUFLO0FBQUssdUJBRVYsS0FBSztBQUFLLHNCQUVWLEtBQUs7QUFBSyxvQkFFVixLQUFLO0FBQUsscUJBRVYsS0FBSztBQUFLLHFCQUVWLEtBQUs7QUFBSyx3QkFFVixLQUFLO0FBQUssMkJBRVYsS0FBSztBQUFLLHFCQUVWLEtBQUs7QUFBSyxrQ0FFVixLQUFLO0FBQUssd0JBSVYsS0FBSztBQUFLLGtCQUNWLFNBQVMsU0FBQyxLQUFLLEVBQUUsRUFBRSxJQUFJLEVBQUUsVUFBVSxFQUFFLE1BQU0sRUFBRSxJQUFJLEVBQUU7QUFBTTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O29CQUFFO0FBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1xuICBBZnRlclZpZXdJbml0LFxuICBDaGFuZ2VEZXRlY3Rpb25TdHJhdGVneSxcbiAgQ29tcG9uZW50LFxuICBJbmplY3QsXG4gIElucHV0LFxuICBPbkRlc3Ryb3ksXG4gIE9uSW5pdCxcbiAgVmlld0NoaWxkLFxuICBFbGVtZW50UmVmLFxuICBQTEFURk9STV9JRCxcbn0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgeyBpc1BsYXRmb3JtQnJvd3NlciB9IGZyb20gJ0Bhbmd1bGFyL2NvbW1vbic7XG5cbmltcG9ydCB7IEFEU0VOU0VfVE9LRU4sIEFkc2Vuc2VDb25maWcgfSBmcm9tICcuL2Fkc2Vuc2UtY29uZmlnJztcblxuQENvbXBvbmVudCh7XG4gIHNlbGVjdG9yOiAnbmcyLWFkc2Vuc2UsbmctYWRzZW5zZScsXG4gIHRlbXBsYXRlOiBgXG4gICAgPGluc1xuICAgICAgI2luc1xuICAgICAgY2xhc3M9XCJhZHNieWdvb2dsZSB7eyBjbGFzc05hbWUgfX1cIlxuICAgICAgW3N0eWxlLmRpc3BsYXldPVwiZGlzcGxheVwiXG4gICAgICBbc3R5bGUud2lkdGgucHhdPVwid2lkdGhcIlxuICAgICAgW3N0eWxlLmhlaWdodC5weF09XCJoZWlnaHRcIlxuICAgICAgW2F0dHIuZGF0YS1hZC1jbGllbnRdPVwiYWRDbGllbnRcIlxuICAgICAgW2F0dHIuZGF0YS1hZC1zbG90XT1cImFkU2xvdFwiXG4gICAgICBbYXR0ci5kYXRhLWFkLWZvcm1hdF09XCJhZEZvcm1hdFwiXG4gICAgICBbYXR0ci5kYXRhLWFkLXJlZ2lvbl09XCJhZFJlZ2lvblwiXG4gICAgICBbYXR0ci5kYXRhLWxheW91dF09XCJsYXlvdXRcIlxuICAgICAgW2F0dHIuZGF0YS1hZHRlc3RdPVwiYWR0ZXN0XCJcbiAgICAgIFthdHRyLmRhdGEtbGF5b3V0LWtleV09XCJsYXlvdXRLZXlcIlxuICAgICAgW2F0dHIuZGF0YS1mdWxsLXdpZHRoLXJlc3BvbnNpdmVdPVwiZnVsbFdpZHRoUmVzcG9uc2l2ZVwiXG4gICAgPlxuICAgIDwvaW5zPlxuICBgLFxuICBjaGFuZ2VEZXRlY3Rpb246IENoYW5nZURldGVjdGlvblN0cmF0ZWd5Lk9uUHVzaCxcbn0pXG5leHBvcnQgY2xhc3MgQWRzZW5zZUNvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCwgQWZ0ZXJWaWV3SW5pdCwgT25EZXN0cm95IHtcbiAgLyoqIGFkc2Vuc2UgYWNjb3VudCBjYS1wdWItWFhYWFhYWFhYWFhYWFhYWCAqL1xuICBASW5wdXQoKSBhZENsaWVudCE6IHN0cmluZztcbiAgLyoqIGFkIHNsb3QvbnVtYmVyICovXG4gIEBJbnB1dCgpIGFkU2xvdCE6IHN0cmluZyB8IG51bWJlcjtcbiAgQElucHV0KCkgYWRGb3JtYXQhOiBzdHJpbmc7XG4gIC8qKiBjYW4gYmUgbWFudWFsbHkgc2V0IGlmIHlvdSBuZWVkIGFsbCBhZHMgb24gYSBwYWdlIHRvIGhhdmUgc2FtZSBpZCBwYWdlLXh4eCAqL1xuICBASW5wdXQoKSBhZFJlZ2lvbiA9ICdwYWdlLScgKyBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMDAwMCkgKyAxO1xuICAvKiogaW5zIGVsZW1lbnQgZGlzcGxheSBzdHlsZSAqL1xuICBASW5wdXQoKSBkaXNwbGF5ITogc3RyaW5nO1xuICAvKiogaW5zIGVsZW1lbnQgaGVpZ2h0IGluIHB4ICovXG4gIEBJbnB1dCgpIHdpZHRoITogbnVtYmVyO1xuICAvKiogaW5zIGVsZW1lbnQgd2lkdGggaW4gcHggKi9cbiAgQElucHV0KCkgaGVpZ2h0ITogbnVtYmVyO1xuICAvKiogdXNlZCBmb3IgaW4tZmVlZCBhZHMgKi9cbiAgQElucHV0KCkgbGF5b3V0ITogc3RyaW5nO1xuICAvKiogdXNlZCBmb3IgaW4tZmVlZCBhZHMgKi9cbiAgQElucHV0KCkgbGF5b3V0S2V5ITogc3RyaW5nO1xuICAvKiogZW5hYmxlIHBhZ2UtbGV2ZWwgYWRzICovXG4gIEBJbnB1dCgpIHBhZ2VMZXZlbEFkcyE6IGJvb2xlYW47XG4gIC8qKiBzZXRzIHVwIHNvbWUgc29ydCBvZiBnb29nbGUgdGVzdCBhZCAqL1xuICBASW5wdXQoKSBhZHRlc3QhOiBzdHJpbmc7XG4gIC8qIHVzZWQgZm9yIGZsZXhpYmxlIGFkcyAqL1xuICBASW5wdXQoKSBmdWxsV2lkdGhSZXNwb25zaXZlITogYm9vbGVhbjtcbiAgLyoqXG4gICAqIGNsYXNzZXMgYXBwbGllZCB0byB0aGUgaW5zIGVsZW1lbnRcbiAgICovXG4gIEBJbnB1dCgpIGNsYXNzTmFtZSA9ICcnO1xuICBAVmlld0NoaWxkKCdpbnMnLCB7IHJlYWQ6IEVsZW1lbnRSZWYsIHN0YXRpYzogdHJ1ZSB9KSBpbnMhOiBFbGVtZW50UmVmO1xuXG4gIGNvbnN0cnVjdG9yKFxuICAgIEBJbmplY3QoQURTRU5TRV9UT0tFTikgcHJpdmF0ZSBjb25maWc6IEFkc2Vuc2VDb25maWcsXG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcbiAgICBASW5qZWN0KFBMQVRGT1JNX0lEKSBwcml2YXRlIHBsYXRmb3JtOiBhbnksXG4gICkge31cblxuICBuZ09uSW5pdCgpOiB2b2lkIHtcbiAgICBjb25zdCBjb25maWcgPSB0aGlzLmNvbmZpZztcbiAgICB0aGlzLmFkQ2xpZW50ID0gdGhpcy5hZENsaWVudCA/PyBjb25maWcuYWRDbGllbnQ7XG4gICAgdGhpcy5hZFNsb3QgPSB0aGlzLmFkU2xvdCA/PyBjb25maWcuYWRTbG90O1xuICAgIHRoaXMuYWRGb3JtYXQgPSB0aGlzLmFkRm9ybWF0ID8/IGNvbmZpZy5hZEZvcm1hdCA/PyAnYXV0byc7XG4gICAgdGhpcy5kaXNwbGF5ID0gdGhpcy5kaXNwbGF5ID8/IGNvbmZpZy5kaXNwbGF5ID8/ICdibG9jayc7XG4gICAgdGhpcy53aWR0aCA9IHRoaXMud2lkdGggPz8gY29uZmlnLndpZHRoO1xuICAgIHRoaXMuaGVpZ2h0ID0gdGhpcy5oZWlnaHQgPz8gY29uZmlnLmhlaWdodDtcbiAgICB0aGlzLmxheW91dCA9IHRoaXMubGF5b3V0ID8/IGNvbmZpZy5sYXlvdXQ7XG4gICAgdGhpcy5sYXlvdXRLZXkgPSB0aGlzLmxheW91dEtleSA/PyBjb25maWcubGF5b3V0S2V5O1xuICAgIHRoaXMucGFnZUxldmVsQWRzID0gdGhpcy5wYWdlTGV2ZWxBZHMgPz8gY29uZmlnLnBhZ2VMZXZlbEFkcztcbiAgICB0aGlzLmFkdGVzdCA9IHRoaXMuYWR0ZXN0ID8/IGNvbmZpZy5hZHRlc3Q7XG4gICAgdGhpcy5mdWxsV2lkdGhSZXNwb25zaXZlID0gdGhpcy5mdWxsV2lkdGhSZXNwb25zaXZlID8/IGNvbmZpZy5mdWxsV2lkdGhSZXNwb25zaXZlO1xuICB9XG4gIG5nT25EZXN0cm95KCk6IHZvaWQge1xuICAgIGNvbnN0IGlmcmFtZSA9IHRoaXMuaW5zLm5hdGl2ZUVsZW1lbnQucXVlcnlTZWxlY3RvcignaWZyYW1lJyk7XG4gICAgaWYgKGlmcmFtZSAmJiBpZnJhbWUuY29udGVudFdpbmRvdykge1xuICAgICAgaWZyYW1lLnNyYyA9ICdhYm91dDpibGFuayc7XG4gICAgICBpZnJhbWUucmVtb3ZlKCk7XG4gICAgfVxuICB9XG5cbiAgbmdBZnRlclZpZXdJbml0KCk6IHZvaWQge1xuICAgIGlmIChpc1BsYXRmb3JtQnJvd3Nlcih0aGlzLnBsYXRmb3JtKSkge1xuICAgICAgdGhpcy5wdXNoKCk7XG4gICAgfVxuICB9XG5cbiAgcHVzaCgpOiB2b2lkIHtcbiAgICBjb25zdCBwOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmcgfCBib29sZWFuPiA9IHt9O1xuICAgIGlmICh0aGlzLnBhZ2VMZXZlbEFkcykge1xuICAgICAgcC5nb29nbGVfYWRfY2xpZW50ID0gdGhpcy5hZENsaWVudDtcbiAgICAgIHAuZW5hYmxlX3BhZ2VfbGV2ZWxfYWRzID0gdHJ1ZTtcbiAgICB9XG5cbiAgICBpZiAod2luZG93KSB7XG4gICAgICB0cnkge1xuICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxuICAgICAgICAoKHdpbmRvdyBhcyBhbnkpLmFkc2J5Z29vZ2xlID0gKHdpbmRvdyBhcyBhbnkpLmFkc2J5Z29vZ2xlIHx8IFtdKS5wdXNoKHApO1xuICAgICAgfSBjYXRjaCB7XG4gICAgICAgIC8vIHBhc3NcbiAgICAgIH1cbiAgICB9XG4gIH1cbn1cbiJdfQ==